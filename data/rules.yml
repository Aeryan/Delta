version: "2.0"

rules:
  - rule: Initialize conversation
    conversation_start: true
    steps:
      - intent: initmsg
      - action: utter_greet
      - action: utter_iamabot
      - action: utter_general_help

  - rule: Two-stage fallback
    steps:
      - intent: nlu_fallback
      - action: utter_ask_rephrase

  - rule: Greet user
    conversation_start: true
    steps:
      - intent: greet
      - action: utter_greet

  - rule: Respond to greet
    steps:
      - intent: greet
      - action: utter_greet
      - action: utter_offer_help

  - rule: Say goodbye anytime the user says goodbye
    steps:
      - intent: goodbye
      - action: utter_bye

  - rule: Say 'I am a bot' anytime the user challenges
    steps:
      - intent: bot_challenge
      - action: utter_iamabot

  - rule: List capabilities anytime the user asks
    steps:
      - intent: request_general_help
      - action: utter_general_help

  - rule: Explain room booking anytime the user asks
    steps:
      - intent: room_help_request
      - action: utter_room_help

  - rule: State the current location anytime the user asks
    steps:
      - intent: location_challenge
      - action: utter_current_location

  - rule: room check response
    steps:
      - intent: check_room
      - action: room_check_form
      - active_loop: room_check_form
      - active_loop: null
      - action: room_check

  - rule: office search initiation
    steps:
      - intent: request_employee_office
      - action: office_search

  - rule: office result print followup
    steps:
      - action: utter_office_result
      - action: reset_all_slots
      - action: utter_offer_additional_help

  - rule: office no result print followup
    steps:
      - action: utter_office_no_result
      - action: reset_all_slots
      - action: utter_offer_additional_help

  - rule: out-of-scope
    steps:
      - intent: out_of_scope
      - action: utter_out_of_scope

  - rule: out-of-scope-specific-room
    steps:
      - intent: out_of_scope_specific_room
      - action: utter_out_of_scope_specific_room

#  - rule: Activate room request form
#    steps:
#      - intent: request_room
#      - action: room_form
#      - active_loop: room_form
#
#  - rule: Submit room request form
#    condition:
#      - active_loop: room_form
#    steps:
#      - action: room_form
#      - active_loop: null
#      - action: utter_submit
#      - action: room_search
#      - action: room_search_results
#
#  - rule: Activate room acceptance form
#    condition:
#      - slot_was_set:
#          - room_search_feedback_required: True
#    steps:
#      - action: utter_bye